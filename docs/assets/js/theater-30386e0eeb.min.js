!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.theaterJS=t():e.theaterJS=t()}(this,function(){return function(e){function t(n){if(r[n])return r[n].exports;var a=r[n]={exports:{},id:n,loaded:!1};return e[n].call(a.exports,a,a.exports,t),a.loaded=!0,a.exports}var r={};return t.m=e,t.c=r,t.p="",t(0)}([function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function u(){function e(e){return x.onStage=e,this}function t(){return x.casting[x.onStage]||null}function r(){return"stopping"===x.status&&(x.status="playing"),"ready"===x.status&&(x.status="playing",n()),this}function n(){if("stopping"===x.status)return x.status="ready",this;if("playing"!==x.status)return this;if(x.currentScene+1>=x.scenario.length)return x.status="ready",h("scenario:end"),this;var t=x.scenario[++x.currentScene];if(0===x.currentScene&&h("scenario:start"),"publisher"===t.name){var r=function(e){return Array.isArray(e)?e:Array.from(e)}(t.args),n=r[0],o=r.slice(1);return h.apply(void 0,a(o)),n()}switch(t.actor&&e(t.actor),h(t.name+":start",t),t.name){case"type":u.apply(void 0,a(t.args));break;case"erase":g.apply(void 0,a(t.args));break;case"callback":(function(e,t){return t.call(this,e),this}).apply(void 0,a(t.args));break;case"wait":(function(e,t){return setTimeout(e.bind(this),t),this}).apply(void 0,a(t.args));break;default:console.debug("No scene handler for "+t.name)}return this}function u(e,r){var n=t(),a=x.options.locale,u=x.options.minSpeed.type,o=x.options.maxSpeed.type,i=n.displayValue,s=-1,l=!1,d=null,p=null,g=f.default.map(r);return r=f.default.strip(r),function t(){var h=f.default.strip(n.displayValue.substr(i.length));if(h===r)return e();var y=h!==r.substr(0,s+1),m=n.shouldBeMistaken(h,r,d,p);if(y&&(l||!m))l=!0,d=null,n.displayValue=i+f.default.inject(h.substr(0,h.length-1),g),p=--s;else{l=!1;var v=r.charAt(++s);m&&(v=c.default.randomCharNear(v,a),null==d&&(d=s)),n.displayValue=i+f.default.inject(h+v,g)}return setTimeout(t,n.getTypingSpeed(u,o))}(),this}function g(e,r){var n=t();if(null==n)return e();if(!0!==y.erase)return n.displayValue="",e();var a=x.options.minSpeed.erase,u=x.options.maxSpeed.erase,o=n.displayValue,i=f.default.map(o),s=(o=f.default.strip(o)).length,c=void 0,d=0;return l.default.isNumber(r)&&(r>0?c=r:d=o.length+r),function t(){return s===d?e():(n.displayValue=f.default.inject(o.substr(0,--s),i),setTimeout(t,c||n.getTypingSpeed(a,u)))}(),this}function h(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=t[0],a=x.events[n]||[];return a.length>0&&a.concat(x.events["*"]||[]).forEach(function(e){return e.apply(void 0,t)}),this}var y=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];if(y=s.default.merge({},p,y),l.default.isNumber(y.minSpeed)){var m=y.minSpeed;y.minSpeed={erase:m,type:m}}if(l.default.isNumber(y.maxSpeed)){var v=y.maxSpeed;y.maxSpeed={erase:v,type:v}}if("detect"===y.locale&&d){var b=d.languages;l.default.isArray(b)&&l.default.isString(b[0])&&(y.locale=b[0].substr(0,2))}c.default.supports(y.locale)||(y.locale=c.default.defaultLocale);var x={options:y,casting:{},status:"ready",onStage:null,currentScene:-1,scenario:[],events:{}};return e(null),Object.freeze(Object.defineProperties({addActor:function(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],r=arguments.length<=2||void 0===arguments[2]?null:arguments[2],n=(0,i.default)(e,t,r);return x.casting[n.name]=n,this},getCurrentActor:t,addScene:function(){for(var e=[],t=arguments.length,a=Array(t),u=0;u<t;u++)a[u]=arguments[u];return function t(r){if(l.default.isArray(r)&&r.forEach(function(e){t(e)}),l.default.isString(r)){var a=r.split(":"),u=void 0;a.length>1&&"\\"!==a[0].charAt(a[0].length-1)&&t({name:"erase",actor:u=a.shift()});var o={name:"type",args:[a.join(":").replace(/\\:/g,":")]};null!=u&&(o.actor=u),t(o)}l.default.isFunction(r)&&t({name:"callback",args:[r]}),l.default.isNumber(r)&&t(r>0?{name:"wait",args:[r]}:{name:"erase",args:[r]}),l.default.isObject(r)&&(l.default.isArray(r.args)||(r.args=[]),r.args.unshift(function(){h(r.name+":end",r),n()}),e.push(r))}([{name:"publisher",args:["sequence:start"]}].concat(a).concat({name:"publisher",args:["sequence:end"]})),Array.prototype.push.apply(x.scenario,e),x.options.autoplay&&r(),this},getCurrentSpeech:function(){var e=x.scenario[x.currentScene];return e&&l.default.isArray(e.args)&&o(e.args,2)[1]||null},play:r,replay:function(e){return("ready"===x.status||l.default.isFunction(e))&&(x.currentScene=-1,"ready"===x.status?r():e()),this},stop:function(){return x.status="stopping",this},on:function(e,t){return e.split(",").forEach(function(e){e=e.trim(),l.default.isArray(x.events[e])||(x.events[e]=[]),x.events[e].push(t)}),this}},{options:{get:function(){return x.options},configurable:!0,enumerable:!0},status:{get:function(){return x.status},configurable:!0,enumerable:!0}}))}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],n=!0,a=!1,u=void 0;try{for(var o,i=e[Symbol.iterator]();!(n=(o=i.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){a=!0,u=e}finally{try{!n&&i.return&&i.return()}finally{if(a)throw u}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),i=n(r(3)),s=n(r(2)),l=n(r(1)),c=n(r(5)),f=n(r(4)),d="undefined"!=typeof window&&window.navigator,p={autoplay:!0,erase:!0,minSpeed:{erase:80,type:80},maxSpeed:{erase:450,type:450},locale:"detect"};u.init=function(){var e=arguments.length<=0||void 0===arguments[0]?"actor":arguments[0],t=u();return t.addActor(e,{accuracy:1,speed:.8}),t},t.default=u,e.exports=t.default},function(e,t){"use strict";function r(e){return{}.toString.call(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default={isNumber:function(e){return"number"==typeof e},isString:function(e){return"[object String]"===r(e)},isObject:function(e){return"[object Object]"===r(e)},isArray:function(e){return"[object Array]"===r(e)},isFunction:function(e){return"function"==typeof e}},e.exports=t.default},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={merge:function(e){for(var t=[].slice.call(arguments,1),r=0,n=t.length;r<n;r++){var a=t[r];for(var u in a)a.hasOwnProperty(u)&&(e[u]=a[u])}return e},random:function(e,t){return Math.floor(Math.random()*(t-e+1))+e},randomFloat:function(e,t){return Math.random()*(t-e)+e},getPercentageOf:function(e,t,r){return e-e*r+t*r}},e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(r(1)),u=n(r(2)),o="undefined"!=typeof window&&window.document,i={speed:.6,accuracy:.6};t.default=function(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],r=arguments.length<=2||void 0===arguments[2]?null:arguments[2],n="",s=void 0;if(a.default.isNumber(t)&&(t={speed:t,accuracy:t}),t=u.default.merge({},i,t),o&&(null==r&&(r="#"+e),a.default.isString(r))){var l=r,c=o.querySelector(l);if(null==c)throw new Error("no matches for "+e+"'s selector: "+l);s=c,r=function(e){s.innerHTML=e}}return a.default.isFunction(r)||(r=console.log.bind(console)),Object.defineProperties({$element:s,getTypingSpeed:function(e,r){var n=u.default.randomFloat(t.speed,1);return u.default.getPercentageOf(r,e,n)},shouldBeMistaken:function(e,r){var n=arguments.length<=2||void 0===arguments[2]?null:arguments[2],o=arguments.length<=3||void 0===arguments[3]?null:arguments[3],i=10*t.accuracy;if(i>=8)return!1;if(e.length<=i)return!1;if(e.length===r.length)return!1;if(a.default.isNumber(n)&&e.length-n>=(i>=6?10-i:4))return!1;if(a.default.isNumber(o)&&e.length-o<=2*Math.max(i,2))return!1;return u.default.randomFloat(0,.8)>t.accuracy}},{displayValue:{get:function(){return n},set:function(e){n=e,r(e)},configurable:!0,enumerable:!0},name:{get:function(){return e},configurable:!0,enumerable:!0}})},e.exports=t.default},function(e,t,r){"use strict";function n(e){var t=e.match(/<([^\s>]+)/);return Boolean(t)&&a.default.indexOf(t[1].toLowerCase())>-1}Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){return e&&e.__esModule?e:{default:e}}(r(7));t.default={strip:function(e){return e.replace(/(<([^>]+)>)/gi,"")},map:function(e){for(var t=/<[^>]+>/gi,r=[],a=[],u=void 0,o=void 0;u=t.exec(e);)"/"===(o={tagName:u[0],position:u.index}).tagName.charAt(1)?o.opener=a.pop():"/"===o.tagName.charAt(o.tagName.length-2)||n(o.tagName)||a.push(o),r.push(o);return r},inject:function(e,t){for(var r=0,n=void 0;r<t.length;r++)n=t[r],e.length>0&&n.position<=e.length?e=e.substr(0,n.position)+n.tagName+e.substr(n.position):n.opener&&n.opener.position<e.length&&(e+=n.tagName);return e}},e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){for(var t={},r=0,n=e.length,a=void 0;r<n;r++)for(var u=0,o=(a=e[r]).length;u<o;u++)t[a[u]]={x:u,y:r};return t}Object.defineProperty(t,"__esModule",{value:!0});var u=n(r(1)),o=n(r(2)),i=n(r(6));for(var s in i.default)if(i.default.hasOwnProperty(s)){var l=i.default[s];i.default[s]={list:l,mapped:a(l)}}t.default={defaultLocale:"en",supports:function(e){return u.default.isObject(i.default[e])},randomCharNear:function(e,t){if(!this.supports(t))throw new Error('locale "'+t+'" is not supported');var r=i.default[t].mapped,n=[],a=/[A-Z]/.test(e),u=r[e=e.toLowerCase()]||[],s=void 0;for(var l in r)r.hasOwnProperty(l)&&l!==e&&(s=r[l],Math.abs(u.x-s.x)<=1&&Math.abs(u.y-s.y)<=1&&n.push(l));var c=n.length>0?n[o.default.random(0,n.length-1)]:this.randomChar(t);return a&&(c=c.toUpperCase()),c},randomChar:function(e){if(!this.supports(e))throw new Error('locale "'+e+'" is not supported');var t=i.default[e].list.join("");return t.charAt(o.default.random(0,t.length-1))}},e.exports=t.default},function(e,t){e.exports={en:["qwertyuiop","asdfghjkl","zxcvbnm"],fr:["azertyuiop","qsdfghjklm","wxcvbn"],da:["qwertyuiopå","asdfghjklæø","zxcvbnm"],de:["qwertzuiopü","asdfghjklöä","yxcvbnm"],pl:["qwertyuiopęó","asdfghjkląśł","zxcvbnmżźćń"],pt:["qwertyuiop","asdfghjklç","zxcvbnm"],ru:["йцукенгшщзх","фывапролджэ","ячсмитьбюъ"],es:["qwertyuiop","asdfghjklñ","zxcvbnm"],el:[";ςερτυθιοπ","ασδφγηξκλ","ζχψωβνμ"]}},function(e,t){e.exports=["area","base","br","col","embed","hr","img","input","keygen","link","menuitem","meta","param","source","track","wbr"]}])});